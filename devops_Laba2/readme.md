Отчёт по лабораторной работе №2
Хорошие и плохие практики при написании Dockerfile

Цель работы
Целью лабораторной работы было изучить принципы контейнеризации приложений с использованием Docker, а также анализ плохих и хороших практик при написании Dockerfile и работе с контейнерами.

В рамках работы необходимо было:
– написать «плохой» Dockerfile с минимум тремя bad practices
– написать «хороший» Dockerfile, в котором эти ошибки исправлены
– описать каждую плохую практику, почему она плохая и как была исправлена
– привести примеры плохих практик при работе с контейнерами

В качестве примера использовалось простое веб-приложение на Python (Flask), файл laba2_app.py.


Плохой Dockerfile (Dockerfile.bad)

В «плохом» Dockerfile были намеренно использованы распространённые ошибки, которые часто допускаются при контейнеризации приложений.

1. Использование тега latest

В плохом Dockerfile использовался базовый образ с тегом latest.
Использование latest не фиксирует конкретную версию образа. Это может привести к ситуации, когда сегодня контейнер собирается и работает корректно, а завтра новая версия образа ломает приложение или зависимости.

В хорошем Dockerfile используется фиксированная версия образа, что гарантирует предсказуемость и стабильность сборки.

2. Множественные инструкции RUN

В плохом Dockerfile каждая операция выполнялась отдельной инструкцией RUN.
Каждая инструкция RUN создаёт отдельный слой образа, что увеличивает его размер и замедляет сборку.

В хорошем Dockerfile команды объединены в одну инструкцию RUN, а также производится очистка кэша, что уменьшает размер итогового образа.

3. Запуск контейнера от root

Если в Dockerfile не указан пользователь, контейнер по умолчанию запускается от root.
Это небезопасно, так как при компрометации приложения злоумышленник получает максимальные права внутри контейнера.

В хорошем Dockerfile создаётся отдельный пользователь, и приложение запускается от его имени, что повышает безопасность.


Хороший Dockerfile (Dockerfile.good)

В хорошем Dockerfile были исправлены все выявленные ошибки:
– используется фиксированная версия базового образа
– уменьшено количество слоёв за счёт объединения RUN
– контейнер запускается от непривилегированного пользователя
– копируются только необходимые файлы приложения (laba2_app.py)

В результате образ получился меньше по размеру, безопаснее и стабильнее при сборке и запуске.


Плохие практики при работе с контейнерами

1. Хранение данных внутри контейнера

Контейнеры являются временными. Все данные, записанные внутрь контейнера, будут потеряны при его удалении или пересоздании.

Неправильно хранить базы данных, логи или важные файлы внутри контейнера.
Правильным решением является использование Docker Volumes или внешних хранилищ для постоянных данных.

2. Использование одного контейнера для нескольких задач

Иногда контейнеры используют как полноценные виртуальные машины, запуская в одном контейнере сразу несколько сервисов.

Это усложняет масштабирование, отладку и нарушает принцип единственной ответственности.
Правильный подход — один контейнер выполняет одну задачу.


Выводы

В ходе лабораторной работы были рассмотрены основные плохие и хорошие практики при написании Dockerfile и работе с контейнерами.

Даже простые ошибки, такие как использование latest, запуск от root или лишние слои образа, могут привести к проблемам с безопасностью и стабильностью.
Применение хороших практик позволяет создавать более надёжные, безопасные и удобные в эксплуатации контейнеры.
